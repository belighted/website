lang: "en"
slug: "memcached-dalli"
originalPath: "https://www.belighted.com/blog/memcached-dalli"
article:
  title: "Application performance improvement via in memory key-value store: MemCached and the Dalli Ruby Gem"
  content: "<span id=\"hs_cos_wrapper_post_body\" class=\"hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_rich_text\" data-hs-cos-general-type=\"meta_field\" data-hs-cos-type=\"rich_text\"><p>Some time ago, as we were facing a performance drop in one of our projects, the decision was made to cache some intensively used data pieces and thus improve the overall system read efficiency.</p>\n<!--more-->\n<p>After some research, we found some interesting key-value stores (as MemCached, Redis,…) which could perfectly do the trick. Since one has to be chosen, we finally picked up Memcached.</p>\n<p>MemCached is an in-memory key-value store for small chunks of arbitrary data (strings, objects) coming from results of database calls, API calls, or page rendering.</p>\n<p>The system uses a client–server architecture wherein servers maintain a key–value associative array and clients populate this array and query it. To do so clients use client-side libraries to contact servers which, by default, expose their service on port 11211.</p>\n<p>Using MemCached in your applications will allow to layer your requests, resulting in faster responses coming from RAM when available and falling back on a slower store such as a database otherwise.</p>\n<p>But pay attention, values stored in MemCached are only available until the server runs out of memory. At which point, oldest data is discarded, a mechanism known as LRU. Therefore, clients must treat Memcached as a transitory cache. They cannot assume that data stored in Memcached is still there when they need it.</p>\n<p>And as quite everything is well thought and done in our ruby world, a MemCached client implementation exists through the ruby Dalli gem (Which is the officiall MemCached client since Rails 4).</p>\n<h2>Installation and usage</h2>\n<p>So, what do we need precisely to incorporate of all these features into our application?</p>\n<p>First of all, an up and running MemCached server (The set up could differ from one OS to another):</p>\n<ul>\n<li>for Mac OS (via HomeBrew):\n<figure class=\"code\">\n\n</figure>\n</li>\n<li>for debian-based linux distributions:\n<figure class=\"code\">\n<div class=\"highlight\"><span>\n</span><table>\n<tbody>\n<tr>\n<td class=\"gutter\">\n<pre class=\"line-numbers\"><span class=\"line-number\">1</span>\n</pre>\n</td>\n<td class=\"code\">\n<pre><code class=\"undefined\"><span class=\"line\">apt-get install memcached</span></code></pre>\n</td>\n</tr>\n</tbody>\n</table><span>\n</span></div>\n</figure>\n</li>\n</ul>\n<p>Then you can simply install the Dalli gem (or put it into your gemfile):</p>\n<figure class=\"code\">\n\n</figure>\n<p>and use it into your ruby/rails project as shown in this piece of code:</p>\n<figure class=\"code\">\n<div class=\"highlight\"><span>\n</span><table>\n<tbody>\n<tr>\n<td class=\"gutter\">\n<pre class=\"line-numbers\"><span class=\"line-number\">1</span>\n<span class=\"line-number\">2</span>\n<span class=\"line-number\">3</span>\n<span class=\"line-number\">4</span>\n</pre>\n</td>\n<td class=\"code\">\n<pre><code class=\"ruby\"><span class=\"line\"><span class=\"nb\"><span class=\"keyword\">require</span></span> <span class=\"s1\"><span class=\"string\">'dalli'</span></span>\n</span><span class=\"line\"><span class=\"n\">dc</span> <span class=\"o\">=</span> <span class=\"ss\"><span class=\"constant\">Dalli</span></span><span class=\"constant\"><span class=\"p\">:</span><span class=\"ss\">:Client</span></span><span class=\"ss\"></span><span class=\"o\">.</span><span class=\"n\">new</span><span class=\"p\">(</span><span class=\"s1\"><span class=\"string\">'localhost:11211'</span></span><span class=\"p\">)</span>\n</span><span class=\"line\"><span class=\"n\">dc</span><span class=\"o\">.</span><span class=\"n\">set</span><span class=\"p\">(</span><span class=\"s1\"><span class=\"string\">'abc'</span></span><span class=\"p\">,</span> <span class=\"mi\"><span class=\"number\">123</span></span><span class=\"p\">)</span>\n</span><span class=\"line\"><span class=\"n\">value</span> <span class=\"o\">=</span> <span class=\"n\">dc</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"s1\"><span class=\"string\">'abc'</span></span><span class=\"p\">)</span>\n</span></code></pre>\n</td>\n</tr>\n</tbody>\n</table><span>\n</span></div>\n</figure>\n<h2>Some tips</h2>\n<p>If you pass an array of strings, for instance: <code>[\"offices\", \"BE\"]</code>, as key. Dalli will concatenate all those using backslashes as separator, resulting into <code>\"offices/BE\"</code> being really sent to the MemCached server.</p>\n<p>You can even contact a MemCached server without ruby or rails using telnet.</p>\n<p>If you’re in a rails project, you can even directly use MemCached as rails cache store via this additional configuration put into the desired environnement configuration file (rails 3 feature) :</p>\n<figure class=\"code\">\n<div class=\"highlight\"><span>\n</span><table>\n<tbody>\n<tr>\n<td class=\"gutter\">\n<pre class=\"line-numbers\"><span class=\"line-number\">1</span>\n</pre>\n</td>\n<td class=\"code\">\n<pre><code class=\"ruby\"><span class=\"line\"><span class=\"n\">config</span><span class=\"o\">.</span><span class=\"n\">cache_store</span> <span class=\"o\">=</span> <span class=\"ss\"><span class=\"symbol\">:dalli_store</span></span>\n</span></code></pre>\n</td>\n</tr>\n</tbody>\n</table><span>\n</span></div>\n</figure>\n<p>We’ll certainly talk about some other no sql alternatives, their advantages, drawbacks and use cases in further blog posts, so stay tuned !</p>\n<h2>References</h2>\n\n<p><!--HubSpot Call-to-Action Code --><span class=\"hs-cta-wrapper\" id=\"hs-cta-wrapper-fb3606cc-cc1b-47d0-ae85-2c9f69837fe2\"><span class=\"hs-cta-node hs-cta-fb3606cc-cc1b-47d0-ae85-2c9f69837fe2\" id=\"hs-cta-fb3606cc-cc1b-47d0-ae85-2c9f69837fe2\"><!--[if lte IE 8]><div id=\"hs-cta-ie-element\"></div><![endif]--><a href=\"https://cta-redirect.hubspot.com/cta/redirect/1684659/fb3606cc-cc1b-47d0-ae85-2c9f69837fe2\" target=\"_blank\"><img class=\"hs-cta-img\" id=\"hs-cta-img-fb3606cc-cc1b-47d0-ae85-2c9f69837fe2\" src=\"https://no-cache.hubspot.com/cta/default/1684659/fb3606cc-cc1b-47d0-ae85-2c9f69837fe2.png\" alt=\"New Call-to-action\"></a></span></span><!-- end HubSpot Call-to-Action Code --></p>\n</span>"
  textBody: ""
  html: "<!--<![endif]--><head>\n    <meta charset=\"utf-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\">\n    <meta name=\"author\" content=\"Stéphane A.\">\n    <meta name=\"description\" content=\"Have some performance drop in one of your application? Discover how we figured it out with one of our project with Memcached and the Dalli Ruby Gem.\">\n    <meta name=\"generator\" content=\"HubSpot\">\n    <title>Application performance improvement via in memory key-value store: MemCached and the Dalli Ruby Gem</title>\n    <link rel=\"shortcut icon\" href=\"https://www.belighted.com/hubfs/logo-belighted.png\">\n    \n\n    \n\n    <meta property=\"og:description\" content=\"Have some performance drop in one of your application? Discover how we figured it out with one of our project with Memcached and the Dalli Ruby Gem.\">\n    <meta property=\"og:title\" content=\"Application performance improvement via in memory key-value store: MemCached and the Dalli Ruby Gem\">\n    <meta name=\"twitter:description\" content=\"Have some performance drop in one of your application? Discover how we figured it out with one of our project with Memcached and the Dalli Ruby Gem.\">\n    <meta name=\"twitter:title\" content=\"Application performance improvement via in memory key-value store: MemCached and the Dalli Ruby Gem\">\n\n\n    <style>\na.cta_button{-moz-box-sizing:content-box !important;-webkit-box-sizing:content-box !important;box-sizing:content-box !important;vertical-align:middle}.hs-breadcrumb-menu{list-style-type:none;margin:0px 0px 0px 0px;padding:0px 0px 0px 0px}.hs-breadcrumb-menu-item{float:left;padding:10px 0px 10px 10px}.hs-breadcrumb-menu-divider:before{content:'›';padding-left:10px}.hs-featured-image-link{border:0}.hs-featured-image{float:right;margin:0 0 20px 20px;max-width:50%}@media (max-width: 568px){.hs-featured-image{float:none;margin:0;width:100%;max-width:100%}}.hs-screen-reader-text{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px}\n</style>\n\n<link rel=\"stylesheet\" href=\"/hs/hsstatic/AsyncSupport/static-1.70/sass/comments_listing_asset.css\">\n<link rel=\"stylesheet\" href=\"/hs/hsstatic/AsyncSupport/static-1.70/sass/rss_post_listing.css\">\n    \n\n    \n    \n\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n\n\n<!-- Facebook Pixel Code -->\n\n<noscript>&lt;img  height=\"1\" width=\"1\" style=\"display:none\" src=\"https://www.facebook.com/tr?id=706355809571598&amp;amp;ev=PageView&amp;amp;noscript=1\"&gt;</noscript>\n<!-- End Facebook Pixel Code -->\n<link rel=\"amphtml\" href=\"https://www.belighted.com/blog/memcached-dalli?hs_amp=true\">\n\n<meta property=\"og:image\" content=\"https://belighted.com/images/default_blogpost_image_6@1x.jpg#keepProtocol\">\n\n<meta name=\"twitter:image\" content=\"https://belighted.com/images/default_blogpost_image_6@1x.jpg#keepProtocol\">\n\n\n<meta property=\"og:url\" content=\"https://www.belighted.com/blog/memcached-dalli\">\n<meta name=\"twitter:card\" content=\"summary\">\n\n<link rel=\"canonical\" href=\"https://www.belighted.com/blog/memcached-dalli\">\n\n<meta property=\"og:type\" content=\"article\">\n<link rel=\"alternate\" type=\"application/rss+xml\" href=\"https://www.belighted.com/blog/rss.xml\">\n<meta name=\"twitter:domain\" content=\"www.belighted.com\">\n\n\n<meta http-equiv=\"content-language\" content=\"en\">\n<link rel=\"stylesheet\" href=\"//cdn2.hubspot.net/hub/-1/hub_generated/template_assets/1495141902003/hubspot_default/shared/responsive/layout.min.css\">\n\n\n<link rel=\"stylesheet\" href=\"https://www.belighted.com/hs-fs/hub/1684659/hub_generated/template_assets/8523445462/1569881984337/Marketplace/Neambo/Act21/Coded_Files/Act21.min.css\">\n\n\n\n\n</head>\n<body class=\"blog-1 featured-image-right   hs-content-id-4747418748 hs-blog-post hs-blog-id-4544204069\" style=\"\"></body>"

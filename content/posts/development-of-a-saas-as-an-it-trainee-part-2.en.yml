lang: "en"
slug: "development-of-a-saas-as-an-it-trainee-part-2"
originalPath: "https://www.belighted.com/blog/development-of-a-saas-as-an-it-trainee-part-2"
title: "Development of a SaaS as an IT trainee : part 2"
author: "Samuel M."
description: "Development of a SaaS with a third-party javascript widget, what Iâ€™ve learned and discovered during my third week as a trainee."
image: "https://belighted.com/images/default_blogpost_image_2@1x.jpg#keepProtocol"
date: 1451606400000
body: "<h2>Introduction</h2>\n<p>This is my second blog post about Pravatar and my third week among the Belighted team is already over, time flies so fast!</p>\n<!--more-->\n<p>In this one, I'll share with you what seemed to me to be the most interesting things to talk about.</p>\n<p>In order not to lose you with my explanations nor to overload you with details about the <strong><a href=\"/saas-guide-to-software-as-service\" rel=\" noopener\" target=\"_blank\">SaaS</a></strong>, I'll begin with a little summary of the main features of Pravatar at the time of writing, then I'll talk about the back-end and the front-end.</p>\n<h2>Pravatar</h2>\n<p>Pravatar now has a default page where guests can register to the service, manage their accounts and set default avatar.</p>\n<p>Client snippet now allows an app to request different versions of an avatar, to upload an avatar for a profile and also to create accounts on the fly.</p>\n<h2>On the Back-end</h2>\n<p>The main tasks on the back-end were to continue building the API and adapting the app in order to suit the client needs, but it led me to make some major changes to the app.</p>\n<h3>Interactor</h3>\n<p>One says :</p>\n<blockquote>\n<p>Fat models skinny controllers.</p>\n</blockquote>\n<p>But Philippe taught me that putting all the logic in models is not the solution either.<br> What we want is to keep in the models their own specialized logic, but we can extract the business logic in a fourth layer which is called an <strong>Interactor</strong>, and which reflects (as the creators of the gem say) what our application <em>does</em>.</p>\n<p>I built an interactor to represent the <em>registration</em> process, it simply creates a <code>user</code> and its <code>account</code> with given parameters, and returns a context with a success or a failure.<br> This <em>interactor</em> is then called by a <em>controller</em>, which will additionaly perform its more specific actions.</p>\n<h3>AWS S3</h3>\n<p>Despite how obscure it sounded to me, setting up S3 to store the <em>avatars</em> was quite fun.</p>\n<p>The <strong>fog</strong> gem provides a cloud services library, which can easily be used with <strong>CarrierWave</strong> to uploads your files to S3.<br> My requirements were to keep the local storage for <em>testing</em>, and to target three different buckets for <em>development</em>, <em>staging</em> and <em>production</em>.</p>\n<p>This was simply done by giving <strong>fog</strong> my AWS credentials, make <strong>CarrierWave</strong> use <em>file</em> or <em>fog</em> storage depending on the current environment, and define the right <em>buckets</em> for the non-testing environments.</p>\n<p>Once configured, no changes were needed in the avatars implementation, <strong>CarrierWave</strong> works like a charm.</p>\n<h2>On the Front-end</h2>\n<h3>Gulp : Comfy Testing &amp; Workflow</h3>\n<p>Lastly, my javascript tests were located in the <code>spec</code> folder which normally concerns the RSpec tests on the Rails app only.<br> The project has two distinct sides but we wanted to keep the client one close the the server one, in order to easily maintain the whole package and simply because the <strong>js snippet</strong> is provided by the Rails app.</p>\n<p>So I created a dedicated directory on the app's root for all the front-end app, and gave it the miraculous tool which is <strong>Gulp</strong>.</p>\n<p>Gulp revealed itself a <strong>freaking great</strong> solution to a whole bunch of current or even future problems :</p>\n<ul>\n<li>How to easily launch tests while working on the app</li>\n<li>How to manage the bundling with jQuery everytime the snippet source change?</li>\n<li>As the tests and sources are written in coffeescript, how to avoid the early solution which was to use the rails assets precompiler?</li>\n</ul>\n<p>The workflow on the widget now goes like this:</p>\n<ol>\n<li>Launch gulp to <code>watch</code> for any changes in my .coffee sources, to compile them if it occurs</li>\n<li>Write the tests</li>\n<li>Write the snippet code, which will be compiled and bundled on the fly, and also automatically tested by gulp &amp; karma with the tests I just wrote.</li>\n</ol>\n<p>Sorry for hating you two weeks ago, testing.</p>\n<h3>Improvements on the Widget</h3>\n<h4>Fetching the avatars</h4>\n<p>First of all, in order to move towards what the project will be later, the avatars are now fetched by the combination of an <strong>account id</strong> and an <strong>external id</strong> referencing the profile.<br> This means an application can register profiles for their users providing Pravatar their \"<em>primary key</em>\", no matter what they are (mails, usernames, ...).</p>\n<h4>Upload and default avatar</h4>\n<p>Account owners are now able to define a default avatar for their profiles, which will automatically be displayed if a requested profile doesn't exist or doesn't have its avatar.</p>\n<p>An upload functionnality has been added to the widget, a pravatar <code>div</code> can now be used to define an upload zone for a requested user, existing or not.<br> If an upload occurs on a non-existing profile, it will be created on the fly by Pravatar on the related account.<br> This is moving towards the <strong>plug'n'play</strong> characteristic of Pravatar, an easy-to-use service and no constraints for the app which will use it.</p>\n<h2>Conclusion</h2>\n<p>Step by step, increment by increment, the SaaS is progressively taking shape.</p>\n<p>It's only the beginning but I really enjoy working on it, and also learning valuable things every day and working with all the people at Belighted.<br><br><!--HubSpot Call-to-Action Code --><span class=\"hs-cta-wrapper\" id=\"hs-cta-wrapper-fb3606cc-cc1b-47d0-ae85-2c9f69837fe2\"><span class=\"hs-cta-node hs-cta-fb3606cc-cc1b-47d0-ae85-2c9f69837fe2\" id=\"hs-cta-fb3606cc-cc1b-47d0-ae85-2c9f69837fe2\"><!--[if lte IE 8]><div id=\"hs-cta-ie-element\"></div><![endif]--><a href=\"https://cta-redirect.hubspot.com/cta/redirect/1684659/fb3606cc-cc1b-47d0-ae85-2c9f69837fe2\" target=\"_blank\"><img class=\"hs-cta-img\" id=\"hs-cta-img-fb3606cc-cc1b-47d0-ae85-2c9f69837fe2\" style=\"border-width:0px;\" src=\"https://no-cache.hubspot.com/cta/default/1684659/fb3606cc-cc1b-47d0-ae85-2c9f69837fe2.png\" alt=\"New Call-to-action\"></a></span></span><!-- end HubSpot Call-to-Action Code --></p>\n<div id=\"disqus_thread\">&nbsp;</div>"
tags:
  - label: "Under the hood"
    value: "under-the-hood"

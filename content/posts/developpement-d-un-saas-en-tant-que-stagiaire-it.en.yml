lang: en
slug: developpement-d-un-saas-en-tant-que-stagiaire-it
originalPath: https://www.belighted.com/blog/developpement-d-un-saas-en-tant-que-stagiaire-it
title: Développement d'un SaaS en tant que stagiaire IT
author: Samuel M.
description: "Développement d'un SaaS avec un widget Javascript tiers : ce que
  j'ai appris et découvert durant ma première semaine de stage."
image: images/blog%20tech%20standard%20image.png
date: 1451606400000
body: >-
  <h2>Introduction</h2>

  <p>Je m’appelle Samuel Monroe, j’ai 23 ans et je suis étudiant à l’EPHEC Louvain-la-Neuve.</p>

  <!--more-->

  <p>Comme je suis actuellement en dernière année de bachelier en IT, j’ai dû trouver une entreprise qui accepte de m’accueillir pour un stage de 15 semaines.</p>

  <p>J’ai donc postulé chez Belighted, qui proposait un stage au sein d’une jeune équipe de développeurs web passionnés et motivés, travaillant sur des projets variés et intéressants. Il m’a semblé que ce serait le meilleur endroit pour acquérir une expérience professionnelle intéressante et des compétences en programmation mais aussi pour apprécier réellement ces 15 semaines.</p>

  <p>C’est ici que commence mon histoire avec Belighted.</p>

  <h2>Mon bagage</h2>

  <p>L’EPHEC se focalise plus sur les réseaux que sur le développement ; de plus, j’ai commencé relativement tard à apprendre mon premier langage de programmation.</p>

  <p>Cependant, j’ai pu apprendre le Pascal, le Java, le C et le PHP durant mes études. Je voulais découvrir d’autres langages et frameworks pour réaliser certains projets, ce qui m’a conduit à <strong>Ruby on Rails</strong> et aux bases de <strong>Javascript</strong>.</p>

  <h2>Le projet SaaS</h2>

  <p>L’objectif de <strong>Pravatar</strong> est de fournir aux applications web une manière simple et efficace de gérer les avatars de leurs utilisateurs, en permettant à chaque utilisateur d’avoir un avatar différent et privé sur chaque application incluant Pravatar, avec une simple ligne de Javascript.</p>

  <p>Cette solution pourrait également éviter à l’équipe de Belighted de devoir mettre en place un service de stockage spécifique, uniquement pour la gestion des avatars, pour chaque application qu’elle crée, en déléguant cela au service Pravatar.</p>

  <p>Le back-end tournerait sur une app <strong>Rails</strong>, fournissant une API et une manière de gérer les comptes. La partie front-end serait composée d’un widget Javascript, qui pourrait être inclus dans une app cliente via un <code>&lt;script&gt;</code> tag qui irait rechercher ce widget fournit par l’app Rails.</p>

  <h2>Ma première semaine</h2>

  <h3>Côté back-end</h3>

  <h4>Premières étapes</h4>

  <p>J’ai passé mon premier jour à configurer mon environnement <strong>Rails</strong> et à me familiariser avec Ie testing <strong>RSpec</strong>. Philippe m’a demandé d’installer <em>ActiveAdmin</em> et de m’exercer un peu à son utilisation, en écrivant quelques tests dans le style User-Story.</p>

  <h4>Les bases du service Pravatar</h4>

  <p>Comme je le décrirai plus tard, le côté client dépendra d’un script (inclus dans l’app cliente), qui interagira avec l’API de l’application. Mes premiers objectifs pour le back-end ont donc été de trouver une manière de fournir le script, construire une API basique et écrire un test à son sujet.</p>

  <h4>Fournir le script</h4>

  <p>Mon principal problème a été de m’assurer que le script serait toujours disponible par son nom en production, comme <code>https://app.io/assets/script.js</code>, et d’éviter un digest sur le nom de document, produit par l’étape de précompilation de l’asset pipeline.</p>

  <p>Cela aurait pu être un problème agaçant, mais j’ai trouvé une gem me permettant d’autoriser à des assets d’être précompilés et accessibles avec et sans ce digest. Il s’agit de la gem <code>non-stupid-digest-assets</code>.</p>

  <h4>Construire l’API</h4>

  <p>Kathleen m’a parlé de la gem <strong>api-versions</strong> pour gérer une API ; ensuite, j’ai créé un contrôleur appelé <code>profile_widgets_controller</code>, héritant du <code>profile_controller</code>.</p>

  <p>Ce contrôleur unique dans l’API fournit uniquement l’url de l’<em>avatar</em> à partir d’un <em>profile_id</em> reçu.</p>

  <h4>Test de l’API</h4>

  <p>Le test est assez simple ; il crée un compte et un profil fictifs et émet une requête avec un ID valide. Ensuite, il vérifie que la réponse a un status <strong>200</strong> et des données valides.</p>

  <h3>Côté front-end</h3>

  <h4>Choix de la technologie</h4>

  <p>Mon objectif a d’abord été de définir quelle technologie utiliser afin de développer le <strong>widget tiers</strong> qui sera inclus dans l’app cliente. Cette solution d’inclusion fait émerger les besoins suivants :</p>

  <ul>

  <li>le widget devrait être simple à installer</li>

  <li>comme il serait écrit dans un framework <em>Javascript</em>, l’ensemble du package ne devrait pas interférer avec la configuration cliente.</li>

  </ul>

  <p>Comme les technologies de WebComponents disponibles actuellement semblent propices aux conflits de version, la solution que j’ai choisie après quelques discussions avec Simon et Maxime a été de regrouper mon code Javascript avec sa version de jQuery complète en utilisant <strong>Browserify</strong>.</p>

  <h4>Le Widget</h4>

  <p>Pour l’instant, le widget est assez simple mais il atteint complètement le premier but, à savoir afficher les pravatars en :</p>

  <ul>

  <li><code>parcourant le DOM en vue d’une div ayant un data-type spécifique</code></li>

  <li>adressant une requête à l’API en utilisant une valeur clé</li>

  <li>ajoutant un tag <code>img</code> au div en utilisant la réponse de l’API.</li>

  </ul>

  <p>Comme le processus devait être lancé par l’événement ready, il a été encapsulé dans un event listener <code>$('document').ready</code> <em>(ce qui allait me causer quelques soucis plus tard)</em>.</p>

  <p>Finalement, Philippe m’a demandé de le réécrire en <strong>Coffeescript</strong>. Je n’avais jamais écrit la moindre ligne en Coffee avant mais je me suis rapidement mis dedans.</p>

  <h4>Le Testing</h4>

  <p>Ce fut la partie la plus <strong>ardue</strong> de ma première semaine.</p>

  <p>J’ai configuré mon environnement de test avec Karma et Jasmine <em>(Jasmine pour garder la syntax BDD de RSpec).</em> Je devais également inclure <code>jasmine-jquery</code>, <code>mock-ajax</code> et <code>jQuery</code> à Karma.</p>

  <p>Mes problèmes principaux furent :</p>

  <ul>

  <li>de comprendre comment fonctionne Karma</li>

  <li>d’admettre que je ne pourrais pas tester le script sans stubber mon API</li>

  <li>de trouver une solution pour tester et contrôler quelque chose qui attendait l’événement ready du DOM, sans savoir exactement quand cet événement se produirait.</li>

  </ul>

  <p>Voici comment j’ai obtenu un test qui fonctionne (jusqu’à présent), avec l’aide précieuse de Michaël et Philippe :</p>

  <ol>

  <li>Dans une section <code>beforeEach</code>, <strong>j’ai ajouté</strong> la div pravatar dans le DOM et <strong>j’ai stubbé</strong> l’API pour intercepter les appels et fournir une réponse spécifique à chacun de ces appels.</li>

  <li>Comme le code était inclus dans le listener <code>$('document').ready</code>, j’ai dû trouver une manière d’appeler ce code quand je le voulais. J’ai réalisé cela en créant un objet <code>window</code> et en lui donnant un méthode unique appelée <code>init()</code>.</li>

  </ol>

  <p>Ensuite, le listener <code>$('document').ready</code> va déclencher la méthode <code>window.object.init()</code>. <em>(Maintenant que je l’écris, ça semble beaucoup plus simple…)</em></p>

  <h2>Conclusion</h2>

  <p>Cette première semaine en tant que stagiaire a été vraiment intéressante ; Philippe m’a donné de nombreux conseils et m’a appris beaucoup de choses utiles.</p>

  <p>Parvenir à avoir des tests Javascript qui tournent après m’être longtemps débattu m’a procuré une certaine satisfaction et même si je suis sûr que je rencontrerai à nouveau des difficultés, je suis réellement motivé par l’envie de réaliser du bon travail.</p>

  <p>J’aime aller travailler chaque jour chez Belighted, et c’est exactement ce que j’attendais de mon stage.<br><br><!--HubSpot Call-to-Action Code --><span class="hs-cta-wrapper" id="hs-cta-wrapper-fb3606cc-cc1b-47d0-ae85-2c9f69837fe2"><span class="hs-cta-node hs-cta-fb3606cc-cc1b-47d0-ae85-2c9f69837fe2" id="hs-cta-fb3606cc-cc1b-47d0-ae85-2c9f69837fe2"><!--[if lte IE 8]><div id="hs-cta-ie-element"></div><![endif]--><a href="https://cta-redirect.hubspot.com/cta/redirect/1684659/fb3606cc-cc1b-47d0-ae85-2c9f69837fe2" target="_blank"><img class="hs-cta-img" id="hs-cta-img-fb3606cc-cc1b-47d0-ae85-2c9f69837fe2" style="border-width:0px;" src="https://no-cache.hubspot.com/cta/default/1684659/fb3606cc-cc1b-47d0-ae85-2c9f69837fe2.png" alt="New Call-to-action"></a></span></span><!-- end HubSpot Call-to-Action Code --></p>

  <div id="disqus_thread">&nbsp;</div>
tags:
  - label: Under the hood
    value: under-the-hood

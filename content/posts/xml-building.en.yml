lang: "en"
slug: "xml-building"
originalPath: "https://www.belighted.com/blog/xml-building"
article:
  title: "Handcrafted xml files with Ruby!"
  content: "<span id=\"hs_cos_wrapper_post_body\" class=\"hs_cos_wrapper hs_cos_wrapper_meta_field hs_cos_wrapper_type_rich_text\" data-hs-cos-general-type=\"meta_field\" data-hs-cos-type=\"rich_text\"><p>On a daily basis we build API in order to feed all our projects ( such as our hot new <a href=\"https://nomadsuite.com/\">NomadSuite</a> ) and in our way to face such difficulties, we rely on the good old JSON format.</p>\n<!--more-->\n<p>But sometimes, the industry standards required us to use the well known and spread XML format.</p>\n<p>Here are two gems that can allow you to easily craft your own xml file, an old one called <a href=\"https://github.com/jimweirich/builder\">Builder</a> and another, a bit more complete, called <a href=\"https://github.com/sparklemotion/nokogiri\">Nokogiri</a>.</p>\n<p>We’ll take this last one to show you, what are these capabilities:</p>\n<p>First of all, add <code>gem \"nokogiri\"</code> to your gemfile and run the <code>bundle install</code> command.</p>\n<p>Then, start to write your script !</p>\n<figure class=\"code\">\n<div class=\"highlight\"><span>\n</span><table>\n<tbody>\n<tr>\n<td class=\"gutter\">\n<pre class=\"line-numbers\"><span class=\"line-number\">1</span>\n<span class=\"line-number\">2</span>\n<span class=\"line-number\">3</span>\n<span class=\"line-number\">4</span>\n<span class=\"line-number\">5</span>\n<span class=\"line-number\">6</span>\n<span class=\"line-number\">7</span>\n<span class=\"line-number\">8</span>\n<span class=\"line-number\">9</span>\n<span class=\"line-number\">10</span>\n<span class=\"line-number\">11</span>\n<span class=\"line-number\">12</span>\n<span class=\"line-number\">13</span>\n<span class=\"line-number\">14</span>\n<span class=\"line-number\">15</span>\n<span class=\"line-number\">16</span>\n<span class=\"line-number\">17</span>\n<span class=\"line-number\">18</span>\n<span class=\"line-number\">19</span>\n<span class=\"line-number\">20</span>\n</pre>\n</td>\n<td class=\"code\">\n<pre><code class=\"ruby\"><span class=\"line\"><span class=\"n\">builder</span> <span class=\"o\">=</span> <span class=\"ss\"><span class=\"constant\">Nokogiri</span></span><span class=\"constant\"><span class=\"p\">:</span><span class=\"ss\">:XML</span><span class=\"o\">::</span><span class=\"no\">Builder</span></span><span class=\"no\"></span><span class=\"o\">.</span><span class=\"n\">new</span><span class=\"p\">(</span><span class=\"ss\"><span class=\"symbol\">:encoding</span></span> <span class=\"o\">=&gt;</span> <span class=\"s1\"><span class=\"string\">'UTF-8'</span></span><span class=\"p\">)</span> <span class=\"k\"><span class=\"keyword\">do</span></span> <span class=\"o\">|</span><span class=\"n\">xml</span><span class=\"o\">|</span>\n</span><span class=\"line\"> <span class=\"n\">xml</span><span class=\"o\">.</span><span class=\"n\"><span class=\"constant\">Documents</span></span> <span class=\"p\">{</span>\n</span><span class=\"line\"> <span class=\"n\">documents</span><span class=\"o\">.</span><span class=\"n\">each</span> <span class=\"k\"><span class=\"keyword\">do</span></span> <span class=\"o\">|</span><span class=\"n\">document</span><span class=\"o\">|</span>\n</span><span class=\"line\"> <span class=\"n\">xml</span><span class=\"o\">.</span><span class=\"n\"><span class=\"constant\">Document</span></span> <span class=\"p\">{</span>\n</span><span class=\"line\"> <span class=\"n\">xml</span><span class=\"o\">.</span><span class=\"n\"><span class=\"constant\">DocumentTypeH</span></span> <span class=\"n\">document</span><span class=\"o\">.</span><span class=\"n\">document_type</span>\n</span><span class=\"line\"> <span class=\"n\">xml</span><span class=\"o\">.</span><span class=\"n\"><span class=\"constant\">DocumentNb</span></span> <span class=\"n\">document</span><span class=\"o\">.</span><span class=\"n\">document_nb</span>\n</span><span class=\"line\"> <span class=\"n\">xml</span><span class=\"o\">.</span><span class=\"n\"><span class=\"constant\">Lines</span></span> <span class=\"p\">{</span>\n</span><span class=\"line\"> <span class=\"n\">document</span><span class=\"o\">.</span><span class=\"n\">lines</span><span class=\"o\">.</span><span class=\"n\">each_with_index</span> <span class=\"k\"><span class=\"keyword\">do</span></span> <span class=\"o\">|</span><span class=\"n\">line</span><span class=\"p\">,</span> <span class=\"n\">index</span><span class=\"o\">|</span>\n</span><span class=\"line\"> <span class=\"n\">xml</span><span class=\"o\">.</span><span class=\"n\"><span class=\"constant\">Line</span></span> <span class=\"p\">{</span>\n</span><span class=\"line\"> <span class=\"n\">xml</span><span class=\"o\">.</span><span class=\"n\"><span class=\"constant\">DocumentType</span></span> <span class=\"n\">document</span><span class=\"o\">.</span><span class=\"n\">document_type</span>\n</span><span class=\"line\"> <span class=\"n\">xml</span><span class=\"o\">.</span><span class=\"n\"><span class=\"constant\">DocumentNb</span></span> <span class=\"n\">document</span><span class=\"o\">.</span><span class=\"n\">document_nb</span>\n</span><span class=\"line\"> <span class=\"n\">xml</span><span class=\"o\">.</span><span class=\"n\"><span class=\"constant\">LineNb</span></span> <span class=\"p\">(</span><span class=\"n\">index</span> <span class=\"o\">+</span> <span class=\"mi\"><span class=\"number\">1</span></span><span class=\"p\">)</span>\n</span><span class=\"line\"> <span class=\"p\">}</span>\n</span><span class=\"line\"> <span class=\"k\"><span class=\"keyword\">end</span></span>\n</span><span class=\"line\"> <span class=\"p\">}</span>\n</span><span class=\"line\"> <span class=\"p\">}</span>\n</span><span class=\"line\"> <span class=\"k\"><span class=\"keyword\">end</span></span>\n</span><span class=\"line\"> <span class=\"p\">}</span>\n</span><span class=\"line\"> <span class=\"k\"><span class=\"keyword\">end</span></span>\n</span><span class=\"line\"><span class=\"n\">builder</span><span class=\"o\">.</span><span class=\"n\">to_xml</span>\n</span></code></pre>\n</td>\n</tr>\n</tbody>\n</table><span>\n</span></div>\n</figure>\n<p>Another option that we consider sometimes, is also to use the famous <code>erb</code> template language to generate the desired XML output.</p>\n<p>For instance, have a look at this small piece of code:</p>\n<p>You basicaly need nothing more than ruby (as <code>erb</code> is a ruby core library).</p>\n<p>Just instanciate the class: <code>ERB.new(File.read(\"./documents.xml.erb\"), 0, '&gt;').result(binding)</code> (<code>binding</code> allow you to access all call context variables).</p>\n<p>Then, here is the XML template:</p>\n<figure class=\"code\">\n<figcaption><span>./documents.xml.erb </span></figcaption>\n<div class=\"highlight\"><span>\n</span><table>\n<tbody>\n<tr>\n<td class=\"gutter\">\n<pre class=\"line-numbers\"><span class=\"line-number\">1</span>\n<span class=\"line-number\">2</span>\n<span class=\"line-number\">3</span>\n<span class=\"line-number\">4</span>\n<span class=\"line-number\">5</span>\n<span class=\"line-number\">6</span>\n<span class=\"line-number\">7</span>\n<span class=\"line-number\">8</span>\n<span class=\"line-number\">9</span>\n<span class=\"line-number\">10</span>\n<span class=\"line-number\">11</span>\n<span class=\"line-number\">12</span>\n<span class=\"line-number\">13</span>\n<span class=\"line-number\">14</span>\n<span class=\"line-number\">15</span>\n<span class=\"line-number\">16</span>\n<span class=\"line-number\">17</span>\n</pre>\n</td>\n<td class=\"code\">\n<pre><code class=\"ruby\"><span class=\"line\"><span class=\"o\">&lt;</span><span class=\"no\">Documents</span><span class=\"o\">&gt;</span>\n</span><span class=\"line\"> <span class=\"o\">&lt;</span><span class=\"sx\">% documents.each </span><span class=\"k\">do</span> <span class=\"o\">|</span><span class=\"n\">document</span><span class=\"o\">|</span> <span class=\"sx\">%&gt;</span>\n</span><span class=\"line\"><span class=\"sx\"> &lt;Document&gt;</span>\n</span><span class=\"line\"> <span class=\"o\">&lt;</span><span class=\"no\">DocumentTypeH</span><span class=\"o\">&gt;&lt;</span><span class=\"sx\">%= document.document_type %&gt;&lt;/DocumentTypeH&gt;</span>\n</span><span class=\"line\"><span class=\"sx\"> &lt;DocumentNb&gt;&lt;%=</span> <span class=\"n\">document</span><span class=\"o\">.</span><span class=\"n\">document_nb</span> <span class=\"sx\">%&gt;&lt;/DocumentNb&gt;</span>\n</span><span class=\"line\"> <span class=\"o\">&lt;</span><span class=\"no\">Lines</span><span class=\"o\">&gt;</span>\n</span><span class=\"line\"> <span class=\"o\">&lt;</span><span class=\"sx\">% document.lines.each_with_index </span><span class=\"k\">do</span> <span class=\"o\">|</span><span class=\"n\">line</span><span class=\"p\">,</span> <span class=\"n\">index</span><span class=\"o\">|</span> <span class=\"sx\">%&gt;</span>\n</span><span class=\"line\"><span class=\"sx\"> &lt;Line&gt;</span>\n</span><span class=\"line\"> <span class=\"o\">&lt;</span><span class=\"no\">DocumentType</span><span class=\"o\">&gt;&lt;</span><span class=\"sx\">%= document.document_type %&gt;&lt;/DocumentType&gt;</span>\n</span><span class=\"line\"><span class=\"sx\"> &lt;DocumentNb&gt;&lt;%=</span> <span class=\"n\">document</span><span class=\"o\">.</span><span class=\"n\">document_nb</span> <span class=\"sx\">%&gt;&lt;/DocumentNb&gt;</span>\n</span><span class=\"line\"> <span class=\"o\">&lt;</span><span class=\"no\">LineNb</span><span class=\"o\">&gt;&lt;%=</span> <span class=\"n\">index</span> <span class=\"o\">+</span> <span class=\"mi\">1</span> <span class=\"sx\">%&gt;&lt;/LineNb&gt;</span>\n</span><span class=\"line\"> <span class=\"o\">&lt;</span><span class=\"sr\">/Line&gt;</span>\n</span><span class=\"line\"><span class=\"sr\"> &lt;% end %&gt;</span>\n</span><span class=\"line\"><span class=\"sr\"> &lt;/</span><span class=\"no\">Lines</span><span class=\"o\">&gt;</span>\n</span><span class=\"line\"> <span class=\"o\">&lt;</span><span class=\"sr\">/Document&gt;</span>\n</span><span class=\"line\"><span class=\"sr\"> &lt;% end %&gt;</span>\n</span><span class=\"line\"><span class=\"sr\">&lt;/</span><span class=\"no\">Documents</span><span class=\"o\">&gt;</span>\n</span></code></pre>\n</td>\n</tr>\n</tbody>\n</table><span>\n</span></div>\n</figure>\n<p>Don’t hesitate to share your xml creation process !<br><!--HubSpot Call-to-Action Code --><span class=\"hs-cta-wrapper\" id=\"hs-cta-wrapper-fb3606cc-cc1b-47d0-ae85-2c9f69837fe2\"><span class=\"hs-cta-node hs-cta-fb3606cc-cc1b-47d0-ae85-2c9f69837fe2\" id=\"hs-cta-fb3606cc-cc1b-47d0-ae85-2c9f69837fe2\"><!--[if lte IE 8]><div id=\"hs-cta-ie-element\"></div><![endif]--><a href=\"https://cta-redirect.hubspot.com/cta/redirect/1684659/fb3606cc-cc1b-47d0-ae85-2c9f69837fe2\" target=\"_blank\"><img class=\"hs-cta-img\" id=\"hs-cta-img-fb3606cc-cc1b-47d0-ae85-2c9f69837fe2\" src=\"https://no-cache.hubspot.com/cta/default/1684659/fb3606cc-cc1b-47d0-ae85-2c9f69837fe2.png\" alt=\"New Call-to-action\"></a></span></span><!-- end HubSpot Call-to-Action Code --></p>\n</span>"
  textBody: ""
  html: "<!--<![endif]--><head>\n    <meta charset=\"utf-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\">\n    <meta name=\"author\" content=\"Stéphane A.\">\n    <meta name=\"description\" content=\"How to easily write your own XML files in Ruby ! 2 methods accessible for all !\">\n    <meta name=\"generator\" content=\"HubSpot\">\n    <title>Handcrafted xml files with Ruby!</title>\n    <link rel=\"shortcut icon\" href=\"https://www.belighted.com/hubfs/logo-belighted.png\">\n    \n\n    \n\n    <meta property=\"og:description\" content=\"How to easily write your own XML files in Ruby ! 2 methods accessible for all !\">\n    <meta property=\"og:title\" content=\"Handcrafted xml files with Ruby!\">\n    <meta name=\"twitter:description\" content=\"How to easily write your own XML files in Ruby ! 2 methods accessible for all !\">\n    <meta name=\"twitter:title\" content=\"Handcrafted xml files with Ruby!\">\n\n\n    <style>\na.cta_button{-moz-box-sizing:content-box !important;-webkit-box-sizing:content-box !important;box-sizing:content-box !important;vertical-align:middle}.hs-breadcrumb-menu{list-style-type:none;margin:0px 0px 0px 0px;padding:0px 0px 0px 0px}.hs-breadcrumb-menu-item{float:left;padding:10px 0px 10px 10px}.hs-breadcrumb-menu-divider:before{content:'›';padding-left:10px}.hs-featured-image-link{border:0}.hs-featured-image{float:right;margin:0 0 20px 20px;max-width:50%}@media (max-width: 568px){.hs-featured-image{float:none;margin:0;width:100%;max-width:100%}}.hs-screen-reader-text{clip:rect(1px, 1px, 1px, 1px);height:1px;overflow:hidden;position:absolute !important;width:1px}\n</style>\n\n<link rel=\"stylesheet\" href=\"/hs/hsstatic/AsyncSupport/static-1.70/sass/comments_listing_asset.css\">\n<link rel=\"stylesheet\" href=\"/hs/hsstatic/AsyncSupport/static-1.70/sass/rss_post_listing.css\">\n    \n\n    \n    \n\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n\n\n<!-- Facebook Pixel Code -->\n\n<noscript>&lt;img  height=\"1\" width=\"1\" style=\"display:none\" src=\"https://www.facebook.com/tr?id=706355809571598&amp;amp;ev=PageView&amp;amp;noscript=1\"&gt;</noscript>\n<!-- End Facebook Pixel Code -->\n<link rel=\"amphtml\" href=\"https://www.belighted.com/blog/xml-building?hs_amp=true\">\n\n<meta property=\"og:image\" content=\"https://www.belighted.com/hubfs/blog%20tech%20standard%20image-1.png#keepProtocol\">\n<meta property=\"og:image:width\" content=\"935\">\n<meta property=\"og:image:height\" content=\"316\">\n<meta property=\"og:image:alt\" content=\"blog tech standard image-1\">\n<meta name=\"twitter:image\" content=\"https://www.belighted.com/hubfs/blog%20tech%20standard%20image-1.png#keepProtocol\">\n<meta name=\"twitter:image:alt\" content=\"blog tech standard image-1\">\n\n<meta property=\"og:url\" content=\"https://www.belighted.com/blog/xml-building\">\n<meta name=\"twitter:card\" content=\"summary_large_image\">\n\n<link rel=\"canonical\" href=\"https://www.belighted.com/blog/xml-building\">\n\n<meta property=\"og:type\" content=\"article\">\n<link rel=\"alternate\" type=\"application/rss+xml\" href=\"https://www.belighted.com/blog/rss.xml\">\n<meta name=\"twitter:domain\" content=\"www.belighted.com\">\n\n\n<meta http-equiv=\"content-language\" content=\"en\">\n<link rel=\"stylesheet\" href=\"//cdn2.hubspot.net/hub/-1/hub_generated/template_assets/1495141902003/hubspot_default/shared/responsive/layout.min.css\">\n\n\n<link rel=\"stylesheet\" href=\"https://www.belighted.com/hs-fs/hub/1684659/hub_generated/template_assets/8523445462/1569881984337/Marketplace/Neambo/Act21/Coded_Files/Act21.min.css\">\n\n\n\n\n</head>\n<body class=\"blog-1 featured-image-right   hs-content-id-4747389103 hs-blog-post hs-blog-id-4544204069\" style=\"\"></body>"
